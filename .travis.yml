language: php
php:
    - 5.5
    - 5.6

before_script:
  - export ADDITIONAL_PATH=`php -i | grep -F --color=never 'Scan this dir for additional .ini files'`
  - echo 'xdebug.max_nesting_level=9999' | sudo tee ${ADDITIONAL_PATH:42}/symfony2.ini
  - mysql -e 'create database IF NOT EXISTS symfony;'
  - cp app/config/parameters.yml.dist app/config/parameters.yml
  - composer install
  - php app/console doctrine:database:create -n --if-not-exists --env=test
  - php app/console doctrine:schema:update -n --force --env=test
  - php app/console doctrine:fixtures:load -n --env=test

script:
  - phpunit -c app

notifications:
  email:
    -  marcmorales83@gmail.com
    -  david@flux.cat
    -  marc@teclliure.net

branches:
  only:
    - master
    - devel
